window.onload=function(){function e(){var e,n,o,a,r,d,c,u,m,s,e,g,h;this.init=function(){this.cacheHTML(),this.uploadImage(),this.dragImage(),this.saveImage(),this.bgAnimation()},this.cacheHTML=function(){n=document.getElementById("canvas"),o=n.getContext("2d"),a=document.getElementById("upload"),r=document.getElementById("file"),range=document.getElementById("range"),c=document.getElementById("download"),d=document.body,u=n.width,m=n.height,o.webkitImageSmoothingEnabled=!1,o.mozImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1,s=new Image,s.setAttribute("crossOrigin","anonymous"),s.onload=function(){y()},s.src="https://raw.githubusercontent.com/gapgag55/Salaya-tour-2017-profile/master/images/frame2.png"},this.uploadImage=function(){r.addEventListener("change",l,!0),a.addEventListener("click",function(){r.click()})},this.dragImage=function(){var t,a,i,r,c,s,l=!1;mousedown=v("touchstart","mousedown"),n.addEventListener(mousedown,function(e){if(l=!0,"touchstart"==mousedown)return t=e.touches[0].pageX,void(a=e.touches[0].pageY);t=e.clientX,a=e.clientY}),mouseup=v("touchend","mouseup"),d.addEventListener(mouseup,function(){l=!1,g=i,h=r}),mousemove=v("touchmove","mousemove"),d.addEventListener(mousemove,function(n){l&&("touchmove"==mousemove?(i=g+(n.touches[0].pageX-t),r=h+(n.touches[0].pageY-a)):(i=g+(n.clientX-t),r=h+(n.clientY-a)),c||s||(c=e.width,s=e.height),o.clearRect(0,0,u,m),o.drawImage(e,i,r,c,s),y())}),range.addEventListener("input",function(){g=0,h=0,i=g,r=h,c=this.value/100*e.width,s=this.value/100*e.height,o.clearRect(0,0,u,m),o.drawImage(e,g,h,c,s),y()})},this.saveImage=function(){c.addEventListener("click",function(){var e=n.toDataURL("image/png");this.href=e})},this.bgAnimation=function(){function e(){this.x=Math.random()*a-a/5,this.y=Math.random()*r,this.r=7.5*Math.random()+3.25}var n=document.getElementById("c"),o=n.getContext("2d"),a=window.innerWidth,r=window.innerHeight,d={x:a/2,y:0};document.addEventListener("mousemove",function(e){d.x=e.clientX||e.pageX,d.y=e.clientY||e.pageY},!1);var c=[];for(i=0;i<70;i++)c.push(new e);var u=function(){for(n.width=a,n.height=r,t=0;t<c.length;t++){var e=c[t],i=e.r+d.x/4.6,u=e.r+d.y/4.6;e.r<10&&(i=e.x+d.x/.5,u=e.y+d.y/.5),e.r<9&&(i=e.x+d.x/2,u=e.y+d.y/2),e.r<8&&(i=e.x+d.x/3.5,u=e.y+d.y/3.5),e.r<7&&(i=e.x+d.x/5,u=e.y+d.y/5),e.r<6&&(i=e.x+d.x/6.5,u=e.y+d.y/6.5),e.r<5&&(i=e.x+d.x/8,u=e.y+d.y/8),e.r<4&&(i=e.x+d.x/9.5,u=e.y+d.y/9.5),e.r<3&&(i=e.x+d.x/11,u=e.y+d.y/11),e.r<2&&(i=e.x+d.x/12.5,u=e.y+d.y/12.5),e.r<1&&(i=e.x+d.x/15,u=e.y+d.y/15),o.beginPath(),o.fillStyle="rgba(255, 255, 255, .3)",o.arc(i,u,e.r,2*Math.PI,!1),o.fill()}};setInterval(u,33)};var l=function(){var e=r.files[0],t=new FileReader;t.onloadend=function(){f(this.result)},t.readAsDataURL(e)},f=function(t){e=new Image,g=0,h=0,e.src=t,e.onload=function(){o.drawImage(e,0,0),y()}},y=function(){o.drawImage(s,0,0,400,400)},v=function(e,t){return console.log(),navigator.userAgent.match(/(Android|iPod|iPhone|iPad)/i)?e:t}}(new e).init()};var randomColor=function(){var e=["#27ae60","#3498db","#9b59b6","#e74c3c","#f39c12"];document.body.style.backgroundColor=e[Math.round(Math.random()*e.length)]};randomColor();